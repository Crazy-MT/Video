package com.weibomovie.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import com.weibomovie.db.DBUtil;
import com.weibomovie.model.Actor;
import com.weibomovie.model.ActorMovie;

public class ActorDao {

	public void addActor(List<Actor> actors) throws SQLException {

		Connection conn = DBUtil.getConnection(); 
		String sql = "insert into actor (name , url) valus(?, ?) ";
		PreparedStatement ptmtSelect = conn.prepareStatement(sql);
		ptmtSelect.setInt(1, movie_id);
		ResultSet rs = ptmtSelect.executeQuery();

		rs.last();
		int rawCount = rs.getRow();
		if (rawCount == 0) {
			for (ActorMovie actor : actors) {
				sql = "insert into actormovie (name , movie_id) values(?,?)";
				PreparedStatement ptmt = conn.prepareStatement(sql);
				ptmt.setString(1, actor.getName());
				ptmt.setInt(2, actor.getMovie_id());
				ptmt.execute();
			}
		}
	}
 

}
